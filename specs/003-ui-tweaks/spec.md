# Feature Specification: Корректировки интерфейса

**Feature Branch**: `003-ui-tweaks`
**Created**: 2026-02-25
**Status**: Draft
**Input**: User description: "Корректировки интерфейса: иконки, дропдаун недель, запоминание состояния, выравнивание элементов, кэширование запросов"

## User Scenarios & Testing *(mandatory)*

### User Story 1 — Визуальные корректировки карточек упражнений (Priority: P1)

Пользователь открывает программу тренировок и видит аккуратно оформленные карточки: порядковый номер упражнения выровнен в верхнем левом углу, бейдж с типом упражнения (подсобка, жим, присед и т.д.) выровнен по правому краю, а для упражнений с индивидуальным подбором веса отображается иконка гантели вместо текстового обозначения. Заголовок "Программа тренировок" убран для экономии места.

**Why this priority**: Визуальная чистота интерфейса — основа удобства в зале. Мелкие недочёты выравнивания мешают быстро считывать информацию.

**Independent Test**: Открыть любой тренировочный день, проверить что номера упражнений выровнены влево-вверх, бейджи — вправо, иконка гантели отображается для индивидуальных упражнений, заголовок отсутствует.

**Acceptance Scenarios**:

1. **Given** открыта программа тренировок, **When** пользователь смотрит на карточку упражнения, **Then** порядковый номер расположен в верхнем левом углу карточки
2. **Given** упражнение имеет тег (подсобка, жим и т.д.), **When** карточка отображается, **Then** бейдж с тегом выровнен по правому краю
3. **Given** упражнение с индивидуальным подбором веса, **When** карточка отображается, **Then** вместо текстового обозначения показана иконка гантели (Dumbbell из Lucide)
4. **Given** пользователь открывает приложение, **When** загружается главная страница, **Then** заголовок "Программа тренировок" отсутствует

---

### User Story 2 — Выбор недели через дропдаун (Priority: P1)

Пользователь выбирает неделю тренировок через компактное дропдаун-меню вместо текущего селектора, что экономит место на экране телефона.

**Why this priority**: Компактный селектор недели освобождает экранное пространство для основного контента — упражнений.

**Independent Test**: Открыть приложение, нажать на дропдаун недели, выбрать другую неделю — контент обновляется.

**Acceptance Scenarios**:

1. **Given** программа загружена, **When** пользователь видит селектор недели, **Then** он отображается как компактное дропдаун-меню
2. **Given** дропдаун открыт, **When** пользователь выбирает неделю, **Then** отображается программа выбранной недели

---

### User Story 3 — Запоминание выбранной недели и дня (Priority: P2)

Пользователь закрывает приложение, открывает снова — и видит ту же неделю и тот же день, на которых остановился. Состояние сохраняется между сессиями.

**Why this priority**: В зале пользователь часто переключается между приложениями. Потеря позиции раздражает и замедляет тренировку.

**Independent Test**: Выбрать неделю 5 и среду, закрыть приложение, открыть заново — отображается неделя 5, среда.

**Acceptance Scenarios**:

1. **Given** пользователь выбрал неделю и день, **When** он закрывает и открывает приложение, **Then** отображается та же неделя и день
2. **Given** сохранённая неделя была удалена из базы, **When** пользователь открывает приложение, **Then** отображается первая доступная неделя

---

### User Story 4 — Кэширование запросов (Priority: P2)

Данные программы тренировок загружаются один раз и кэшируются на клиенте. При переключении между неделями и днями повторные запросы к серверу не выполняются, если данные уже загружены.

**Why this priority**: В зале интернет может быть нестабильным. Кэширование обеспечивает мгновенное переключение между неделями без ожидания.

**Independent Test**: Загрузить программу, переключиться на другую неделю (первый запрос), вернуться обратно — данные отображаются мгновенно без запроса к серверу.

**Acceptance Scenarios**:

1. **Given** данные недели загружены, **When** пользователь переключается на неё повторно, **Then** данные отображаются мгновенно из кэша
2. **Given** приложение только открыто, **When** пользователь переключается на новую неделю, **Then** выполняется запрос к серверу и данные кэшируются

---

### Edge Cases

- Что если сохранённая неделя/день больше не существуют? Показывается первая доступная неделя и первый день.
- Что если кэш содержит устаревшие данные? Данные программы статичны (не меняются после загрузки), поэтому кэш валиден в рамках сессии.
- Что если в программе только одна неделя? Дропдаун всё равно отображается, но с одним пунктом.

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: Система MUST отображать иконку гантели (Dumbbell) для упражнений с индивидуальным подбором веса
- **FR-002**: Система MUST отображать выбор недели как дропдаун-меню
- **FR-003**: Система MUST сохранять выбранную неделю и день между сессиями пользователя
- **FR-004**: Система MUST восстанавливать сохранённую позицию при повторном открытии приложения
- **FR-005**: Система MUST выравнивать порядковый номер упражнения в верхнем левом углу карточки
- **FR-006**: Система MUST выравнивать бейдж с типом упражнения по правому краю карточки
- **FR-007**: Система MUST убрать заголовок "Программа тренировок" с главной страницы
- **FR-008**: Система MUST кэшировать загруженные данные и не выполнять повторные запросы при переключении на ранее загруженную неделю
- **FR-009**: Система MUST откатываться к первой доступной неделе, если сохранённая неделя не найдена

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: Переключение на ранее загруженную неделю происходит мгновенно (без сетевого запроса)
- **SC-002**: После перезапуска приложения пользователь видит ту же неделю и день, что выбрал ранее
- **SC-003**: Все визуальные корректировки (иконки, выравнивание, дропдаун, удаление заголовка) соответствуют описанным требованиям
- **SC-004**: Дропдаун выбора недели занимает меньше места на экране, чем текущий селектор

## Assumptions

- Данные программы тренировок статичны в рамках сессии и не обновляются на сервере в реальном времени
- Zustand используется как state manager (явно указано пользователем)
- Иконки берутся из библиотеки Lucide (уже используется в проекте через shadcn/ui)
- Дропдаун реализуется компонентом из shadcn/ui (явно указано пользователем)
